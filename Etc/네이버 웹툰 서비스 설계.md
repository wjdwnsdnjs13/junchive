# 네이버 웹툰 서비스 설계
## 1단계 - 요구사항 분석
### 중점적으로 분석할 부분
- 웹툰
  - 이미지는 확장자와 10MB 제한이 있음
  - 평균 이미지 용량은 7MB로 정함
  - 평균 이미지 컷은 80개로 계산함
  - 하루 웹툰은 100개 업로드 된다고 가정
- 알림 서비스
  - 웹툰이 업로드되면 구독자에게 알림을 보냄
- DAU는 400만으로 가정
- 유저는 하루 3개의 웹툰을 본다고 가정
- QPS = 140
  - 4_000_000 * 3질의/24시간/3_600초 = 약 140
- 최대 QPS = 280
- 서비스는 전세계에서 접속할 수 있어야 함
- 랭킹 시스템
  - 조회수, 좋아요, 댓글 수를 기반으로 랭킹을 매김

## 2단계 - 개략적 설계안 제시
### 웹툰 서비스
- 웹툰 조회
- 웹툰 좋아요
- 웹툰 댓글
- 웹툰 랭킹
- 웹툰 검색
- 웹툰 추천
- 웹툰 구독
- 웹툰 구독 취소

### 웹툰 업로드 알림 서비스
- 웹툰 업로드 알림
- 구독자 알림 서비스

### 웹툰 업로드 서비스
- 웹툰 업로드    
- 웹툰 업로드 알림
- 웹툰 업로드 랭킹

## 3단계 - 상세 설계
![네이버 웹툰 서비스 설계 아키텍처.png](img/%EB%84%A4%EC%9D%B4%EB%B2%84%20%EC%9B%B9%ED%88%B0%20%EC%84%9C%EB%B9%84%EC%8A%A4%20%EC%84%A4%EA%B3%84%20%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98.png)

### 웹툰 서비스
- 웹툰은 전세계에서 접근할 수 있으므로 CDN을 통해 이미지를 제공
- 자주 조회되는 웹툰의 메타데이터는 캐싱
- 좋아요는 캐시로 사용되는 Redis를 통해 동시성 제어
- 웹툰 댓글
- 웹툰 랭킹
  - 랭킹 시스템은 어떻게 구성해야할지 고민이네요...
  - 웹툰 추천도 마찬가지
- 웹툰 검색
  - 웹툰 검색은 무겁게 가져갈 이유 없이 서비스에서 대략적으로 처리
- 웹툰 구독
- 웹툰 구독 취소

### 웹툰 업로드 알림 서비스
- 웹툰 업로드 알림
- 구독자 알림 서비스

### 웹툰 업로드 서비스
- 웹툰 업로드
- 웹툰 업로드 알림
- 웹툰 업로드 랭킹

# 4단계
## 추가 논의점
- 결제 관련
  - 결제 시스템을 어떻게 구성할 것인가
  - 쿠키를 어떻게 관리할 것인가
  - 나라 별 환율 등에 대한 정보는 어떻게 할 것인가
  - 

### Q) 웹툰이 특정 시간에 오픈이 되는데, 이때에는 캐시에 웹툰이 없으므로 캐시 미스가 발생하게 됨. 이를 어떻게 해결하겠는가?
- 웹툰 업로드와 함께 캐시에 미리 업로드 해두면 될 것 같음.
  - prewarming
  - 4개 정도의 캐시 전략이 있음. 공부해볼 것.

### Q) 웹툰이라면 정보의 저작권과 보호가 중요할 것 같은데 어떻게 할 수 있을까?
- SSL을 차용해본 생각
  - 특정 클라이언트에서 사용할 수 있는 암복호화 로직을 사용해서 '보호 키'를 만들어서 사용
  - SSL 처럼 해당 '보호 키'를 발급하고 관리하는 서비스를 만듦.
  - 이 서비스를 통해서 특정 클라이언트만 해당 웹툰을 볼 수 있도록 만듦.
- 이미지 스크램블이라는 방법이 있음.
  - 이미지의 순서를 섞어서 암호화
  - 불법으로 가져가도 순서를 알 수 없도록